// FarmLife RPG - Database Schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Main player/user model
model Player {
  id        String   @id @default(cuid())
  name      String
  energy    Int      @default(100)
  maxEnergy Int      @default(100)
  coins     Int      @default(500)
  xp        Int      @default(0)
  level     Int      @default(1)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  crops      Crop[]
  livestock  Livestock[]
  inventory  InventoryItem[]
  chores     ChoreLog[]
  events     GameEvent[]
  gameState  GameState?

  @@map("players")
}

// Crop types available in the game
enum CropType {
  WHEAT
  CORN
  TOMATO
  CARROT
  POTATO
  STRAWBERRY
  PUMPKIN
  LETTUCE
}

// Growth stages
enum GrowthStage {
  PLANTED
  SEEDLING
  GROWING
  MATURE
  READY
  WITHERED
}

// Crops planted on the farm
model Crop {
  id           String       @id @default(cuid())
  playerId     String
  type         CropType
  stage        GrowthStage  @default(PLANTED)
  plotX        Int
  plotY        Int
  plantedAt    DateTime     @default(now())
  wateredToday Boolean      @default(false)
  health       Int          @default(100)
  daysGrowing  Int          @default(0)

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, plotX, plotY])
  @@map("crops")
}

// Animal types
enum LivestockType {
  CHICKEN
  COW
  SHEEP
  PIG
  GOAT
}

// Livestock on the farm
model Livestock {
  id              String        @id @default(cuid())
  playerId        String
  type            LivestockType
  name            String?
  health          Int           @default(100)
  happiness       Int           @default(100)
  hunger          Int           @default(100)
  fedToday        Boolean       @default(false)
  petToday        Boolean       @default(false)
  productionReady Boolean       @default(false)
  producedToday   Boolean       @default(false)
  acquiredAt      DateTime      @default(now())

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@map("livestock")
}

// Resource types for inventory
enum ResourceType {
  // Seeds
  WHEAT_SEEDS
  CORN_SEEDS
  TOMATO_SEEDS
  CARROT_SEEDS
  POTATO_SEEDS
  STRAWBERRY_SEEDS
  PUMPKIN_SEEDS
  LETTUCE_SEEDS

  // Harvested crops
  WHEAT
  CORN
  TOMATO
  CARROT
  POTATO
  STRAWBERRY
  PUMPKIN
  LETTUCE

  // Animal products
  EGG
  MILK
  WOOL
  MEAT

  // Tools & items
  WATER_CAN
  HOE
  FEED
  FERTILIZER
}

// Player inventory
model InventoryItem {
  id        String       @id @default(cuid())
  playerId  String
  type      ResourceType
  quantity  Int          @default(1)

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, type])
  @@map("inventory")
}

// Chore types
enum ChoreType {
  WATER_CROPS
  FEED_ANIMALS
  HARVEST_CROPS
  COLLECT_PRODUCTS
  CLEAR_WEEDS
  REPAIR_FENCE
}

// Daily chores and completed tasks
model ChoreLog {
  id          String    @id @default(cuid())
  playerId    String
  type        ChoreType
  description String
  xpReward    Int       @default(10)
  coinReward  Int       @default(0)
  completed   Boolean   @default(false)
  completedAt DateTime?
  createdAt   DateTime  @default(now())

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@map("chore_logs")
}

// Random event types
enum EventType {
  WEATHER
  VISITOR
  ANIMAL_EVENT
  CROP_EVENT
  MARKET
  SPECIAL
}

// Game events (weather, visitors, etc.)
model GameEvent {
  id          String    @id @default(cuid())
  playerId    String
  type        EventType
  title       String
  description String
  effect      String?
  createdAt   DateTime  @default(now())

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@map("game_events")
}

// Seasons
enum Season {
  SPRING
  SUMMER
  FALL
  WINTER
}

// Time of day
enum TimeOfDay {
  MORNING
  AFTERNOON
  EVENING
  NIGHT
}

// Game state (time, season, etc.)
model GameState {
  id         String    @id @default(cuid())
  playerId   String    @unique
  day        Int       @default(1)
  season     Season    @default(SPRING)
  year       Int       @default(1)
  timeOfDay  TimeOfDay @default(MORNING)
  lastPlayed DateTime  @default(now())

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@map("game_state")
}
